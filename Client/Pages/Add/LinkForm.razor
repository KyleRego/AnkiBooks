@using System.ComponentModel.DataAnnotations
@inject ILogger<LinkForm> Logger
@inject HttpClient Http

<EditForm Model="Model" OnValidSubmit="Submit" FormName="AddLinkForm">
    <DataAnnotationsValidator />
    <ValidationSummary />
    <label>
        URL:
        <InputText @bind-Value="Model!.URL" />
    </label>
    <button type="submit">Submit</button>
</EditForm>

@code {
    // TODO: Do not hard code the backend origin
    private const string endpoint = "http://localhost:5229/api/Links";

    [SupplyParameterFromForm]
    public Link? Model { get; set; }

    protected override void OnInitialized() => Model ??= new Link();

    private async Task Submit()
    {
        Logger.LogInformation("Submit button clicked Url was = {URL}", Model?.URL);
        ArgumentNullException.ThrowIfNull(Model?.URL);
        Link linkData = new Link { URL = Model.URL, IsComplete = false };
        HttpResponseMessage response = await Http.PostAsJsonAsync(endpoint, linkData);
    }

    public class Link
    {
        public long LinkId { get; set; }

        public string? URL { get; set; }

        public bool IsComplete { get; set; }
    }
}