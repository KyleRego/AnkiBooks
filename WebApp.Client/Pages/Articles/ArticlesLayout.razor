@inherits LayoutComponentBase

@layout MainLayout

@using AnkiBooks.WebApp.Client.Shared.Heroicons
@using AnkiBooks.WebApp.Client.Pages.Articles.ArticlesTree

<div class="d-flex flex-row">
    <div id="articles-sidebar" class="flex-shrink-0 flex-position-sticky left-0 top-0 bottom-0
                                    h-screen w-64 border-right-primary
                                    @(articlesSidebarExpanded == false ? "d-none" : "d-block" )">
        <div class="pt-4 mx-4 d-flex justify-content-between">
            <div>
                [Articles Tree Switcher]
            </div>

            <div class="w-6 h-6 cursor-pointer" role="button" @onclick="ToggleArticlesSidebar">
                <BookOpen />
            </div>
        </div>

        <ArticlesTree />
    </div>

    <div class="w-100">
        <div class="my-4 mr-4 d-flex justify-content-start">

            <div class="@(articlesSidebarExpanded == true ? "d-none" :
                                                            "w-64 d-flex flex-row justify-content-between border-right-primary-spacing" )">
                <div class="pl-4">
                    [Articles Tree Switcher]
                </div>

                <div class="pr-4">
                    <div class="w-6 h-6 cursor-pointer" role="button" @onclick="ToggleArticlesSidebar">
                        <BookOpen />
                    </div>
                </div>
            </div>

            <div class="d-flex flex-row justify-content-start">
                <div class="pl-4">
                    @if (ReadMode == false)
                    {
                        <span role="button" @onclick="StartReadMode">Read mode</span>
                    }
                    else
                    {
                        <span role="button" @onclick="EndReadMode">Edit mode</span>
                    }
                </div>

                <div>
                    <SectionOutlet SectionName="article-title" />
                </div>
            </div>
        </div>

        <CascadingValue Value="@ReadMode" Name="ReadMode">
            <div>
                @Body
            </div>
        </CascadingValue>
    </div>
</div>

@code {
    public bool ReadMode { get; set; } = false;

    private void StartReadMode() => ReadMode = true;

    private void EndReadMode() => ReadMode = false;

    private void ToggleArticlesSidebar()
    {
        articlesSidebarExpanded = !articlesSidebarExpanded;
    }

    private bool articlesSidebarExpanded = true;
}