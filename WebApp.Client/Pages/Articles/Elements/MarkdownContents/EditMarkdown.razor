@using System.ComponentModel.DataAnnotations
@using System.Text.Json

@using AnkiBooks.ApplicationCore.Entities
@using AnkiBooks.ApplicationCore.Enums
@using AnkiBooks.ApplicationCore.Interfaces
@using AnkiBooks.ApplicationCore.Services

@inherits EditArticleElementBase<MarkdownContent>

@inject IMarkdownContentService MarkdownContentService

<MarkdownForm   InitialArticleElement="@InitialArticleElement"
                EditingExisting="true"
                ParentSubmitMethod="@SubmitForm"
                ParentCancelMethod="@Cancel"  />

@code {
    private async Task SubmitForm(MarkdownContent editedMarkdown)
    {
        MarkdownContent? updatedMarkdown = await MarkdownContentService.PutMarkdownContent(editedMarkdown);
        ArgumentNullException.ThrowIfNull(updatedMarkdown);

        Editing = false;
        await EditingChanged.InvokeAsync(Editing);
    }
}