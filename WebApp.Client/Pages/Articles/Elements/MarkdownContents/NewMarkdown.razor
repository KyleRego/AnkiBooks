@using System.ComponentModel.DataAnnotations
@using System.Text.Json

@using AnkiBooks.ApplicationCore.Entities
@using AnkiBooks.ApplicationCore.Enums
@using AnkiBooks.ApplicationCore.Interfaces
@using AnkiBooks.ApplicationCore.Services

@inherits NewArticleElementBase<MarkdownContent>

@inject IMarkdownContentService MarkdownContentService

<MarkdownForm   InitialArticleElement="@InitialArticleElement()"
                EditingExisting="false"
                ParentSubmitMethod="@SubmitForm"
                ParentCancelMethod="@Cancel"  />

@code {
    private async Task SubmitForm(MarkdownContent newMarkdownContent)
    {
        newMarkdownContent.OrdinalPosition = OrdinalPosition;

        MarkdownContent? createdContent = await MarkdownContentService.PostMarkdownContent(newMarkdownContent);
        ArgumentNullException.ThrowIfNull(createdContent);

        await AddArticleElementToArticle(createdContent);
    }
}