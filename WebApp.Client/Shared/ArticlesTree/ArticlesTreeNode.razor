@using AnkiBooks.ApplicationCore.Entities
@using AnkiBooks.WebApp.Client.Shared.Heroicons

<li>
    <div class="d-flex justify-content-between align-items-center">
        <div class="flex-grow-1 d-flex px-4 py-2 hover:bg-primary-light align-items-center" @onclick="ExpandOrCollapse">
            <div class="w-5 h-5 flex-none mr-2">
            @if (Expanded == false)
            {
                <ChevronRight />
            }
            else
            {
                <ChevronDown />
            }
            </div>
            <NavLink href="@($"articles/{Article.Id}")" class="word-break-all mr-2">@Article.Title</NavLink>
        </div>
    </div>

    @if (Expanded == true)
    {
        <ul class="pl-4">
            @foreach (Article article in Article.ChildArticles)
            {
                <ArticlesTreeNode Article="@article" @bind-Articles="@Articles" />
            }

            <NewArticle @bind-Articles="@Articles" ParentArticle="@Article" />
        </ul>
    }
</li>

@code {
    [Parameter]
    public Article Article { get; set; } = null!;

    [Parameter]
    public List<Article> Articles { get; set; } = null!;

    [Parameter]
    public EventCallback<List<Article>> ArticlesChanged { get; set; }

    private bool Expanded = false;

    private void ExpandOrCollapse()
    {
        Expanded = !Expanded;
    }
}